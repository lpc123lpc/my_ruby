<p id="notice"><%= notice %></p>

<h1>图书信息</h1>

<%= form_with(url: '/books', method: 'get', local: true) do %>
  <%= text_field_tag(:search) %>
  <%= submit_tag("Search") %>
<% end %>

<%= link_to "Advanced Search", new_search_path %>

<table>
  <thead>
    <tr>
      <th>Id</th>
      <th>Title</th>
      <th>Author</th>
      <th>Press</th>
      <th>Price</th>
      <th>Intime</th>
      <th>Category</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @books.each do |book| %>
      <tr>
        <td><%= book.id %></td>
        <td><%= book.title %></td>
        <td><%= book.author %></td>
        <td><%= book.press %></td>
        <td><%= book.price %></td>
        <td><%= book.intime %></td>
        <td><%= book.category %></td>
        <td><%= link_to 'Show', book %></td>
        <td><%= link_to '编辑图书信息', edit_book_path(book) %></td>
        <td><%= link_to '删除图书', book, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <% if book.author == "已借阅" || book.author == "已损坏"%>
          <td><%= "暂时无法借阅" %></td>
        <% else %>
          <td><%= link_to '借阅本书', new_borrowtable_path(:book_id => book.id, :book_title => book.title) %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Book', new_book_path %>
